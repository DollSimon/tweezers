

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tweezer.noise package &mdash; Tweezer 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Tweezer 0.1 documentation" href="index.html"/>
        <link rel="up" title="tweezer package" href="tweezer.html"/>
        <link rel="next" title="tweezer.physics package" href="tweezer.physics.html"/>
        <link rel="prev" title="tweezer.math package" href="tweezer.math.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Tweezer</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing the tweezer package</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using the tweezer package</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">tweezer</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tweezer.html">tweezer package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="References.html">References</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Tweezer</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="modules.html">tweezer</a> &raquo;</li>
      
          <li><a href="tweezer.html">tweezer package</a> &raquo;</li>
      
    <li>tweezer.noise package</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/tweezer.noise.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="tweezer-noise-package">
<h1>tweezer.noise package<a class="headerlink" href="#tweezer-noise-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tweezer.noise.allan">
<span id="tweezer-noise-allan-module"></span><h2>tweezer.noise.allan module<a class="headerlink" href="#module-tweezer.noise.allan" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tweezer.noise.allan.allan_variance_r_port">
<tt class="descclassname">tweezer.noise.allan.</tt><tt class="descname">allan_variance_r_port</tt><big>(</big><em>data</em>, <em>frequency</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/allan.html#allan_variance_r_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.allan.allan_variance_r_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the allan variance.</p>
</dd></dl>

<dl class="function">
<dt id="tweezer.noise.allan.allan_variance_single_trap">
<tt class="descclassname">tweezer.noise.allan.</tt><tt class="descname">allan_variance_single_trap</tt><big>(</big><em>tau</em>, <em>gamma=4e-05</em>, <em>k=0.0002</em>, <em>kBT=4.114333424000001</em>, <em>asDataFrame=True</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/allan.html#allan_variance_single_trap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.allan.allan_variance_single_trap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tweezer.noise.allan.allan_variance_single_trap_thermal_limit">
<tt class="descclassname">tweezer.noise.allan.</tt><tt class="descname">allan_variance_single_trap_thermal_limit</tt><big>(</big><em>tau</em>, <em>gamma=4e-05</em>, <em>k=0.0002</em>, <em>kBT=4.114333424000001</em>, <em>asDataFrame=True</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/allan.html#allan_variance_single_trap_thermal_limit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.allan.allan_variance_single_trap_thermal_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Theoretical limit of Allan variance of a bead in an optical trap.</p>
<img src="_images/mathmpl/math-ed7a70ee2e.png" class="center" /></dd></dl>

<dl class="function">
<dt id="tweezer.noise.allan.generate_allan_tau">
<tt class="descclassname">tweezer.noise.allan.</tt><tt class="descname">generate_allan_tau</tt><big>(</big><em>data</em>, <em>rate</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/allan.html#generate_allan_tau"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.allan.generate_allan_tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates tau, or time lag, values for Allan variance calculations.</p>
</dd></dl>

</div>
<div class="section" id="module-tweezer.noise.filter">
<span id="tweezer-noise-filter-module"></span><h2>tweezer.noise.filter module<a class="headerlink" href="#module-tweezer.noise.filter" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tweezer.noise.filter.savitzky_golay">
<tt class="descclassname">tweezer.noise.filter.</tt><tt class="descname">savitzky_golay</tt><big>(</big><em>y</em>, <em>window_size=151</em>, <em>order=5</em>, <em>deriv=0</em>, <em>rate=1</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/filter.html#savitzky_golay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.filter.savitzky_golay" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth (and optionally differentiate) data with a Savitzky-Golay filter.
The Savitzky-Golay filter removes high frequency noise from data.
It has the advantage of preserving the original shape and
features of the signal better than other types of filtering
approaches, such as moving averages techniques.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>y</strong> : array_like, shape (N,)</p>
<blockquote>
<div><p>the values of the time history of the signal.</p>
</div></blockquote>
<p><strong>window_size</strong> : int</p>
<blockquote>
<div><p>the length of the window. Must be an odd integer number.</p>
</div></blockquote>
<p><strong>order</strong> : int</p>
<blockquote>
<div><p>the order of the polynomial used in the filtering.
Must be less then <cite>window_size</cite> - 1.</p>
</div></blockquote>
<p><strong>deriv: int</strong></p>
<blockquote>
<div><p>the order of the derivative to compute (default = 0 means only smoothing)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ys</strong> : ndarray, shape (N)</p>
<blockquote class="last">
<div><p>the smoothed signal (or it&#8217;s n-th derivative).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The Savitzky-Golay is a type of low-pass filter, particularly
suited for smoothing noisy data. The main idea behind this
approach is to make for each point a least-square fit with a
polynomial of high order over a odd-sized window centered at
the point.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R1]</a></td><td>A. Savitzky, M. J. E. Golay, Smoothing and Differentiation of
Data by Simplified Least Squares Procedures. Analytical
Chemistry, 1964, 36 (8), pp 1627-1639.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R2]</a></td><td>Numerical Recipes 3rd Edition: The Art of Scientific Computing
W.H. Press, S.A. Teukolsky, W.T. Vetterling, B.P. Flannery
Cambridge University Press ISBN-13: 9780521880688</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>t = np.linspace(-4, 4, 500)
y = np.exp( -t**2 ) + np.random.normal(0, 0.05, t.shape)
ysg = savitzky_golay(y, window_size=31, order=4)
import matplotlib.pyplot as plt
plt.plot(t, y, label=&#8217;Noisy signal&#8217;)
plt.plot(t, np.exp(-t**2), &#8216;k&#8217;, lw=1.5, label=&#8217;Original signal&#8217;)
plt.plot(t, ysg, &#8216;r&#8217;, label=&#8217;Filtered signal&#8217;)
plt.legend()
plt.show()</p>
</dd></dl>

</div>
<div class="section" id="tweezer-noise-ocl-filter-module">
<h2>tweezer.noise.ocl_filter module<a class="headerlink" href="#tweezer-noise-ocl-filter-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tweezer.noise.pwc">
<span id="tweezer-noise-pwc-module"></span><h2>tweezer.noise.pwc module<a class="headerlink" href="#module-tweezer.noise.pwc" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tweezer.noise.pwc.pwc_bilateral">
<tt class="descclassname">tweezer.noise.pwc.</tt><tt class="descname">pwc_bilateral</tt><big>(</big><em>Y</em>, <em>beta=200</em>, <em>width=5</em>, <em>maxIter=50</em>, <em>stopTolerance=0.001</em>, <em>softKernel=1</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/pwc.html#pwc_bilateral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.pwc.pwc_bilateral" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs piecewise constant denoising of the input signal using hard or
soft bilateral filtering</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Y</strong> : Numpy array</p>
<blockquote>
<div><p>Original signal to denoise, length N</p>
</div></blockquote>
<p><strong>beta</strong> : number, default 200</p>
<blockquote>
<div><p>Kernel parameter. If soft Gaussian kernel, then this is the precision
parameter. If hard kernel, this is the kernel support</p>
</div></blockquote>
<p><strong>width</strong> : number, default 5</p>
<blockquote>
<div><p>Spatial kernel width W</p>
</div></blockquote>
<p><strong>maxIter</strong> : int, default 50</p>
<blockquote>
<div><p>Maximum number of iterations</p>
</div></blockquote>
<p><strong>stopTolerance</strong> : number, default 1e-3</p>
<blockquote>
<div><p>Precision of estimate as determined by square magnitude of the change
in the solution.</p>
</div></blockquote>
<p><strong>softKernel</strong> : int, default = 1</p>
<blockquote>
<div><p>Kernel, either &#8216;soft&#8217; (1) or &#8216;hard&#8217; (0)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>X</strong> : Numpy array</p>
<blockquote class="last">
<div><p>Denoised output signal</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tweezer.noise.utils">
<span id="tweezer-noise-utils-module"></span><h2>tweezer.noise.utils module<a class="headerlink" href="#module-tweezer.noise.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tweezer.noise.utils.generate_lorentzian_power_noise">
<tt class="descclassname">tweezer.noise.utils.</tt><tt class="descname">generate_lorentzian_power_noise</tt><big>(</big><em>cornerFrequency=100</em>, <em>diffusionCoef=1</em>, <em>nSamples=500000.0</em>, <em>normalize=False</em>, <em>deterministicSpectrum=True</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/utils.html#generate_lorentzian_power_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.utils.generate_lorentzian_power_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tweezer.noise.utils.generate_power_noise">
<tt class="descclassname">tweezer.noise.utils.</tt><tt class="descname">generate_power_noise</tt><big>(</big><em>alpha=1</em>, <em>nSamples=100000.0</em>, <em>normalize=False</em>, <em>deterministicSpectrum=True</em><big>)</big><a class="reference internal" href="_modules/tweezer/noise/utils.html#generate_power_noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tweezer.noise.utils.generate_power_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate samples of power law noise. The power spectrum
of the signal scales as f^(-alpha).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>alpha</strong> : number</p>
<blockquote>
<div><p>Scaling exponent for the power law. <strong>Default: 1</strong></p>
</div></blockquote>
<p><strong>nSamples</strong> : int</p>
<blockquote>
<div><p>Number of samples to produce. <strong>Default: 1e5</strong></p>
</div></blockquote>
<p><strong>normalize</strong> : bool</p>
<blockquote>
<div><p>Whether to map the resulting series to the  range [-1, 1]. <strong>Default: False</strong></p>
</div></blockquote>
<p><strong>deterministicSpectrum</strong> : bool</p>
<blockquote>
<div><p>To switch between deterministic and stochastic distribution
of power spectrum (see details). <strong>Default: True</strong></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>X</strong> : numpy.array</p>
<blockquote class="last">
<div><p>of the signal whose frequency response follows the power law</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-contents">
<h2>Module contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-tweezer.noise"></span><p>Module that contains routines for noise analysis of time series</p>
<p>One key aspect is to port the Steps and Bumps Toolkit from Matlab to Python</p>
<p>Refs:</p>
<p>[1] M.A. Little, P.E. McSharry, S.J. Roberts, D.A.E. Costello, I.M.
Moroz (2007), Exploiting Nonlinear Recurrence and Fractal Scaling
Properties for Voice Disorder Detection, BioMedical Engineering OnLine</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tweezer.physics.html" class="btn btn-neutral float-right" title="tweezer.physics package"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tweezer.math.html" class="btn btn-neutral" title="tweezer.math package"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012, Marcus Jahnel.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>